filename <- basename(url)
download.file(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
nonsmoke <- filter(babies, smoke==0) %>% select(bwt) %>% unlist
library(rafalib)
library(dplyr)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download.file(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
nonsmoke <- filter(babies, smoke==0) %>% select(bwt) %>% unlist
smoke <- filter(babies, smoke==1) %>% select(bwt) %>% unlist
mean(bwt.nonsmoke)-mean(bwt.smoke)
popsd(bwt.nonsmoke)
popsd(bwt.smoke)
library(rafalib)
library(dplyr)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download.file(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
mean(bwt.nonsmoke)-mean(bwt.smoke)
popsd(bwt.nonsmoke)
popsd(bwt.smoke)
bwt.nonsmoke <- filter(babies, smoke==0) %>% select(bwt) %>% unlist
bwt.smoke <- filter(babies, smoke==1) %>% select(bwt) %>% unlist
mean(bwt.nonsmoke)-mean(bwt.smoke)
popsd(bwt.nonsmoke)
popsd(bwt.smoke)
mean(bwt.nonsmoke)
mean(bwt.smoke)
mean(bwt.nonsmoke)-mean(bwt.smoke)
popsd(bwt.nonsmoke)
popsd(bwt.smoke)
nonsmoke <- sample(bwt.nonsmoke,5)
smoke <- sample(bwt.smoke,5)
t.test(nonsmoke, smoke)
nonsmoke <- sample(bwt.nonsmoke,5)
set.seed(1)
smoke <- sample(bwt.smoke,5)
t.test(nonsmoke, smoke)
library(rafalib)
library(dplyr)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download.file(url, destfile=filename,echo=FALSE)
library(rafalib)
library(dplyr)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download.file(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
library(rafalib)
library(dplyr)
url <- "https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/babies.txt"
filename <- basename(url)
download.file(url, destfile=filename)
babies <- read.table("babies.txt", header=TRUE)
install.packages(Hmisc)
install.packages('Hmisc')
library(Hmisc)
install.packages(acepack)
install.packages('acepack')
install.packages("acepack")
library(Hmisc)
verion
version
library(foreign)
library(ggplot2)
library(GGally)
getwd()
setwd('/Users/henrikeckermann/Documents/workspace/Website/mysite/main/templates/Blok 1/Multivariate Statistics/HW2')
data_full <- read.spss('REGRESS.SAV',to.data.frame = T)
data <- data_full[,2:5]
# convert to csv (had diffuclties importing .SAV in Python)
write.csv(data, file = 'REGRESSION.csv')
head(data)
str(data)
ggpairs(data, aes(alpha=0.1),lower = list(continuous = "smooth"))
fit <- lm(timedrs ~ phyheal + menheal + stress, data)
apply(data, 2, shapiro.test)
ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='black', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
ggplot(data, aes(sample=timedrs)) +
stat_qq() +
labs(y = 'timedrs')
data$leverage <- hatvalues(fit)
ggplot(data, aes(x = rownames(data), leverage)) +
geom_point(alpha=0.2) +
ylim(0,1) +
xlab('Case') +
theme(axis.text.x = element_blank())
data$cooks.distance <- cooks.distance(fit)
data$residuals <- resid(fit)
data$residuals.standard <- rstandard(fit)
data$residual.studentized <- rstudent(fit)
write.table(data, 'data_R.dat', sep='\t', row.names=F)
sum(data$residuals.standard > 2 | data$residuals.standard < -2)/nrow(data) # are 95% within +/- 2.58?
fit.hat <- hatvalues(fit)
id.fit.hat <- which(fit.hat > (2*(3+1)/nrow(data))) ##  hatvalue > #2or3*(k+1)/n
fit.hat[id.fit.hat]
sum(data$cooks.distance > 1)
fitted.values()
fit.fitted.values
fit$fitted.values
spreadLevelPlot(fit)
fit
class(fit)
data$fitted <- fit$fitted.values
data$cooks.distance <- cooks.distance(fit)
data$residuals <- resid(fit)
data$residuals.standard <- rstandard(fit)
data$residuals.studentized <- rstudent(fit)
write.table(data, 'data_R.dat', sep='\t', row.names=F)
sum(data$residuals.standard > 2 | data$residuals.standard < -2)/nrow(data) # are 95% within +/- 2.58?
data$fitted <- fit$fitted.values
ggplot(data, aes(x = residuals.studentized)) +
geom_histogram(aes(y = ..density..), color = 'black', fill = 'white') +
labs(x = 'Studentized Residual', y = 'Density') +
stat_function(fun = dnorm, args = list(mean = mean(data$residuals.studentized, sd = sd(data$residuals.studentized, color = 'red', size = 1))))
data$fitted <- fit$fitted.values
ggplot(data, aes(x = residuals.studentized)) +
geom_histogram(aes(y = ..density..), color = 'black', fill = 'white') +
labs(x = 'Studentized Residual', y = 'Density') +
stat_function(fun = dnorm, args = list(mean = mean(data$residuals.studentized), sd = sd(data$residuals.studentized)), color = 'red', size = 1)
data$fitted <- fit$fitted.values
ggplot(data, aes(x = residuals.studentized)) +
geom_histogram(aes(y = ..density..), color = 'black', fill = 'white') +
labs(x = 'Studentized Residual', y = 'Density') +
stat_function(fun = dnorm, args = list(mean = mean(data$residuals.studentized), sd = sd(data$residuals.studentized)), color = 'red', size = 1)
qqplot(sample = data$residuals.studentized, stat='qq') +
labs(x = 'Theoretical Values', y = 'Observer Values')
qqplot(sample = data$residuals.studentized, stat='qq') +
labs(x = 'Theoretical Values', y = 'Observer Values'))
qqplot(sample = data$residuals.studentized, stat='qq') +
labs(x = 'Theoretical Values', y = 'Observer Values')
qqplot(sample = data$residuals.studentized, stat='qq')
qqplot(x= data$residuals.studentized, stat='qq')
qqplot(sample = data$residuals.studentized, stat='qq')
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = Studentized REsidual')
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
#qqplot(sample = data$residuals.studentized, stat='qq')
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
ggplot(data, aes(x= dnorm(nrow(data)), y = residuals.studentized)) +
stat_qq()
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
ggplot(data, aes(x= dnorm(nrow(data)), y = residuals.studentized)) +
stat_qq(sample= residuals.studentized)
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
ggplot(data, aes(x= dnorm(nrow(data)), y = residuals.studentized)) +
stat_qq(sample=residuals.studentized)
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
ggplot() +
stat_qq(sample= residuals.studentized, data)
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
ggplot(data, aes(sample = residuals.studentized)) +
stat_qq()
#qqplot(sample = data$residuals.studentized, stat='qq')
ggplot(data, aes(sample = residuals.studentized)) +
stat_qq()
ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
plot(fit)
library(foreign)
library(ggplot2)
library(GGally)
library(gvlma)
gvlma(fit)
ggplot(data, aes(sample = residuals.studentized)) +
stat_qq()
shapiro.test(data$timedrs)
shapiro.test(data$timedrs)
p <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='black', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='black', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p
p.nnq <- ggplot(data, aes(sample=timedrs)) +
stat_qq() +
labs(y = 'timedrs')
p.nnq
p.nn
p.nn <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='black', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p.nn
p.nn
p.nnq
p.nn <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='skyblue', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='black', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p.nn
p.nn <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='black', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p.nn
p.nn <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='skyblue', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p.nn
p.nn <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='blue', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p.nn
p.nn <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='red', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p.nn
p.nn
p.nnq
p.hs <- ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
p.hs
p.hs2 <- ggplot(data, aes(sample = residuals.studentized)) +
stat_qq()
p.hs2
data$fitted <- fit$fitted.values
p.hs3 <- ggplot(data, aes(x = residuals.studentized)) +
geom_histogram(aes(y = ..density..), color = 'black', fill = 'white') +
labs(x = 'Studentized Residual', y = 'Density') +
stat_function(fun = dnorm, args = list(mean = mean(data$residuals.studentized), sd = sd(data$residuals.studentized)), color = 'red', size = 1)
data$fitted <- fit$fitted.values
p.hs3 <- ggplot(data, aes(x = residuals.studentized)) +
geom_histogram(aes(y = ..density..), color = 'black', fill = 'white') +
labs(x = 'Studentized Residual', y = 'Density') +
stat_function(fun = dnorm, args = list(mean = mean(data$residuals.studentized), sd = sd(data$residuals.studentized)), color = 'red', size = 1)
p.hs3
p.hs3
p.hs2
p.hs
getwd()
setwd("/Users/henrikeckermann/Documents/workspace/Website/mysite/main/templates/R")
setwd("/Users/henrikeckermann/Documents/workspace/Website/mysite/main/templates/R/Pics_R/")
data$timedrs.log <- log((data$timedrs+1))
shapiro.test(data$timedrs.log)
ggplot(data, aes(x=timedrs.log)) +
geom_histogram(aes(y = ..density..)) +
stat_function(fun = dnorm, color = 'red', args = list(mean(data$timedrs.log), sd = sd(data$timedrs.log)), size = 1)
stat_function(fun = dnorm, color='red', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
ggplot(data, aes(x=timedrs.log)) +
geom_histogram(aes(y = ..density..)) +
stat_function(fun = dnorm, color = 'red', args = list(mean(data$timedrs.log), sd = sd(data$timedrs.log)), size = 1)
ggplot(data, aes(x=timedrs.log, fill = 'white')) +
geom_histogram(aes(y = ..density..)) +
stat_function(fun = dnorm, color = 'red', args = list(mean(data$timedrs.log), sd = sd(data$timedrs.log)), size = 1)
ggplot(data, aes(x=timedrs.log)) +
geom_histogram(aes(y = ..density..), col = 'black', fill = 'white') +
stat_function(fun = dnorm, color = 'red', args = list(mean(data$timedrs.log), sd = sd(data$timedrs.log)), size = 1)
ggplot(data, aes(x=timedrs.log)) +
geom_histogram(aes(y = ..density..), col = 'black', fill = 'white') +
stat_function(fun = dnorm, color = 'red', args = list(mean(data$timedrs.log), sd = sd(data$timedrs.log)), size = 1)
ggplot(data, aes(sample = timedrs.log)) +
stat_qq()
library(foreign)
library(ggplot2)
library(GGally)
library(gvlma)
library(reshape2)
melt(data)
head(data)
X <- melt(data[,2:4])
data$X <- X
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_smooth(method = 'lm')
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(method = 'lm') +
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(method = 'lm') +
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(method = 'lm')
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(method = 'lm') +
geom_smoth()
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(method = 'lm') +
geom_smooth()
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(method = 'lm', alpha = 0.4) +
geom_smooth()
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = menheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = menheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = stress , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = menheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = stress , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = phyheal , y = timedrs.log)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = menheal , y = timedrs.log)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = stress , y = timedrs.log)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
fit.log <- lm(timedrs.log ~ phyheal + menheal + stress, data)
data$log.leverage <- hatvalues(fit.log)
ggplot(data, aes(x = rownames(data), log.leverage)) +
geom_point(alpha=0.2) +
ylim(0,1) +
xlab('Case') +
theme(axis.text.x = element_blank())
fit.log <- lm(timedrs.log ~ phyheal + menheal + stress, data)
data$log.residuals.standard <- rstandard(fit.log)
data$log.cooks.distance <- cooks.distance(fit.log)
data$log.residuals.studentized <- rstudent(fit.log)
write.table(data, 'data_R.dat', sep='\t', row.names=F)
sum(data$log.residuals.standard > 2 | data$log.residuals.standard < -2)/nrow(data) # are 95% within +/- 2.58?
fit.log.hat <- hatvalues(fit.log)
id.fit.log.hat <- which(fit.log.hat > (2*(3+1)/nrow(data))) ##  hatvalue > #2or3*(k+1)/n
fit.log.hat[id.fit.log.hat]
sum(data$log.cooks.distance > 1)
sum(data$log.cooks.distance > 1)
fit.log <- lm(timedrs.log ~ phyheal + menheal + stress, data)
data$log.residuals.standard <- rstandard(fit.log)
data$log.cooks.distance <- cooks.distance(fit.log)
data$log.residuals.studentized <- rstudent(fit.log)
write.table(data, 'data_R.dat', sep='\t', row.names=F)
sum(data$log.residuals.standard > 2 | data$log.residuals.standard < -2)/nrow(data) # are 95% within +/- 2.58?
fit.log.hat <- hatvalues(fit.log)
id.fit.log.hat <- which(fit.log.hat > (2*(3+1)/nrow(data))) ##  hatvalue > #2or3*(k+1)/n
fit.log.hat[id.fit.log.hat]
head(data)
str(data)
ggpairs(data, aes(alpha=0.1),lower = list(continuous = "smooth"))
head(data)
head(data)
str(data)
ggpairs(data[,1:4], aes(alpha=0.1),lower = list(continuous = "smooth"))
ggplot(data, aes(x = phyheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = menheal , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = stress , y = timedrs)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
fit <- lm(timedrs ~ phyheal + menheal + stress, data)
shapiro.test(data$timedrs)
p.nn <- ggplot(data, aes(x = timedrs)) +
geom_histogram(aes(y=..density..), color='black', fill='grey') +
geom_rug() +
stat_function(fun = dnorm, color='red', args = list(mean = mean(data$timedrs), sd = sd(data$timedrs)), size =1)
p.nn
p.nnq <- ggplot(data, aes(sample=timedrs)) +
stat_qq() +
labs(y = 'timedrs')
p.nnq
data$fitted <- fit$fitted.values
p.hs3 <- ggplot(data, aes(x = residuals.studentized)) +
geom_histogram(aes(y = ..density..), color = 'black', fill = 'white') +
labs(x = 'Studentized Residual', y = 'Density') +
stat_function(fun = dnorm, args = list(mean = mean(data$residuals.studentized), sd = sd(data$residuals.studentized)), color = 'red', size = 1)
p.hs3
p.hs2 <- ggplot(data, aes(sample = residuals.studentized)) +
stat_qq()
p.hs2
p.hs <- ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
p.hs
data$leverage <- hatvalues(fit)
ggplot(data, aes(x = rownames(data), leverage)) +
geom_point(alpha=0.2) +
ylim(0,1) +
xlab('Case') +
theme(axis.text.x = element_blank())
data$cooks.distance <- cooks.distance(fit)
data$residuals <- resid(fit)
data$residuals.standard <- rstandard(fit)
data$residuals.studentized <- rstudent(fit)
write.table(data, 'data_R.dat', sep='\t', row.names=F)
sum(data$residuals.standard > 2 | data$residuals.standard < -2)/nrow(data) # are 95% within +/- 2.58?
fit.hat <- hatvalues(fit)
id.fit.hat <- which(fit.hat > (2*(3+1)/nrow(data))) ##  hatvalue > #2or3*(k+1)/n
fit.hat[id.fit.hat]
sum(data$cooks.distance > 1)
plot(fit)
gvlma(fit)
data$timedrs.log <- log((data$timedrs+1))
ggplot(data, aes(x=timedrs.log)) +
geom_histogram(aes(y = ..density..), col = 'black', fill = 'white') +
stat_function(fun = dnorm, color = 'red', args = list(mean(data$timedrs.log), sd = sd(data$timedrs.log)), size = 1)
ggplot(data, aes(sample = timedrs.log)) +
stat_qq()
shapiro.test(data$timedrs.log)
ggplot(data, aes(x = phyheal , y = timedrs.log)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = menheal , y = timedrs.log)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
ggplot(data, aes(x = stress , y = timedrs.log)) +
geom_point() +
geom_smooth(aes(col = 'red'), method = 'lm', alpha = 0.4) +
geom_smooth(aes(col = 'skyblue'))
data$log.leverage <- hatvalues(fit.log)
ggplot(data, aes(x = rownames(data), log.leverage)) +
geom_point(alpha=0.2) +
ylim(0,1) +
xlab('Case') +
theme(axis.text.x = element_blank())
fit.log <- lm(timedrs.log ~ phyheal + menheal + stress, data)
data$log.residuals.standard <- rstandard(fit.log)
data$log.cooks.distance <- cooks.distance(fit.log)
data$log.residuals.studentized <- rstudent(fit.log)
write.table(data, 'data_R.dat', sep='\t', row.names=F)
sum(data$log.residuals.standard > 2 | data$log.residuals.standard < -2)/nrow(data) # are 95% within +/- 2.58?
fit.log.hat <- hatvalues(fit.log)
id.fit.log.hat <- which(fit.log.hat > (2*(3+1)/nrow(data))) ##  hatvalue > #2or3*(k+1)/n
fit.log.hat[id.fit.log.hat]
data$log.fitted <- fit.log$fitted.values
p.log.hs3 <- ggplot(data, aes(x = log.residuals.studentized)) +
geom_histogram(aes(y = ..density..), color = 'black', fill = 'white') +
labs(x = 'Log Studentized Residual', y = 'Density') +
stat_function(fun = dnorm, args = list(mean = mean(data$log.residuals.studentized), sd = sd(data$log.residuals.studentized)), color = 'red', size = 1)
p.log.hs3
p.log.hs2 <- ggplot(data, aes(sample = log.residuals.studentized)) +
stat_qq()
p.hs2
p.log.hs <- ggplot(data, aes(x = fitted, y= log.residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Log Studentized Residual')
p.log.hs
p.hs <- ggplot(data, aes(x = fitted, y= residuals.studentized)) +
geom_point() +
geom_smooth(method = 'lm', color = 'Blue') +
labs(x = 'Fitted Values', y = 'Studentized Residual')
p.hs
